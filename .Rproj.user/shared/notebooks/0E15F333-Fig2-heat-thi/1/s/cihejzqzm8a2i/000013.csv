"0","plot.thi <- dwd.data %>%"
"0","  ggplot() +"
"0","  # bull 1:  14.06.2018 until 13.08.2018"
"0","  # bull 1:  28.12.2018 until 26.02.2019"
"0","  annotate(geom = ""rect"", "
"0","           xmin = ymd_hms(""2018-06-14 00:00:00""),"
"0","           xmax = ymd_hms(""2018-08-13 23:00:00""), "
"0","           ymin = 4, ymax = 85,"
"0","           fill = ""grey60"", colour = NA, alpha = 0.2) +"
"0","  geom_segment(aes(x    = ymd_hms(""2018-08-13 23:00:00""), "
"0","                   xend = ymd_hms(""2018-08-13 23:00:00""), "
"0","                   y = 4, yend = 85), "
"0","               linetype = ""dashed"", linewidth = 0.4) +"
"0","  annotate(geom  = ""text"","
"0","           x     = ymd_hms(""2018-08-13 23:00:00""),"
"0","           y     = 4, "
"0","           label = ""bull 1"", "
"0","           size = 8/2.845276, angle = 90, hjust = -0.4, vjust = -0.5) +"
"0","  annotate(geom = ""rect"", "
"0","           xmin = ymd_hms(""2018-12-28 00:00:00""),"
"0","           xmax = ymd_hms(""2019-02-26 23:00:00""), "
"0","           ymin = 4, ymax = 85,"
"0","           fill = ""grey60"", colour = NA, alpha = 0.2) +"
"0","  geom_segment(aes(x    = ymd_hms(""2019-02-26 23:00:00""), "
"0","                   xend = ymd_hms(""2019-02-26 23:00:00""), "
"0","                   y = 4, yend = 85), "
"0","               linetype = ""dashed"", linewidth = 0.4) +"
"0","  annotate(geom  = ""text"","
"0","           x     = ymd_hms(""2019-02-26 23:00:00""),"
"0","           y     = 4, "
"0","           label = ""bull 1"", "
"0","           size = 8/2.845276, angle = 90, hjust = -0.4, vjust = -0.5) +"
"0","  # bull 2:  31.05.2018 until 30.07.2018"
"0","  # bull 2:  16.12.2018 until 14.02.2019"
"0","  annotate(geom = ""rect"", "
"0","           xmin = ymd_hms(""2018-05-31 00:00:00""),"
"0","           xmax = ymd_hms(""2018-07-30 23:00:00""), "
"0","           ymin = 3, ymax = 84,"
"0","           fill = ""grey60"", colour = NA, alpha = 0.2) +"
"0","  geom_segment(aes(x    = ymd_hms(""2018-07-30 23:00:00""), "
"0","                   xend = ymd_hms(""2018-07-30 23:00:00""), "
"0","                   y = 3, yend = 84),"
"0","               linetype = ""dashed"", linewidth = 0.4) +"
"0","  annotate(geom  = ""text"","
"0","           x     = ymd_hms(""2018-07-30 23:00:00""),"
"0","           y     = 3, "
"0","           label = ""bull 2"", "
"0","           size = 8/2.845276, angle = 90, hjust = -0.4, vjust = -0.5) +"
"0","  annotate(geom = ""rect"", "
"0","           xmin = ymd_hms(""2018-12-16 00:00:00""),"
"0","           xmax = ymd_hms(""2019-02-14 23:00:00""), "
"0","           ymin = 3, ymax = 84,"
"0","           fill = ""grey60"", colour = NA, alpha = 0.2) +"
"0","  geom_segment(aes(x    = ymd_hms(""2019-02-14 23:00:00""), "
"0","                   xend = ymd_hms(""2019-02-14 23:00:00""), "
"0","                   y = 3, yend = 84),"
"0","               linetype = ""dashed"", linewidth = 0.4) +"
"0","  annotate(geom  = ""text"","
"0","           x     = ymd_hms(""2019-02-14 23:00:00""),"
"0","           y     = 3, "
"0","           label = ""bull 2"", "
"0","           size = 8/2.845276, angle = 90, hjust = -0.4, vjust = -0.5) +"
"0","  # bull 3:  17.05.2018 until 16.07.2018"
"0","  # bull 3:  08.11.2018 until 07.01.2019"
"0","  annotate(geom = ""rect"", "
"0","           xmin = ymd_hms(""2018-05-17 00:00:00""),"
"0","           xmax = ymd_hms(""2018-07-16 23:00:00""), "
"0","           ymin = 2, ymax = 83,"
"0","           fill = ""grey60"", colour = NA, alpha = 0.2) +"
"0","  geom_segment(aes(x    = ymd_hms(""2018-07-16 23:00:00""), "
"0","                   xend = ymd_hms(""2018-07-16 23:00:00""), "
"0","                   y = 2, yend = 83),"
"0","               linetype = ""dashed"", linewidth = 0.4) +"
"0","  annotate(geom  = ""text"","
"0","           x     = ymd_hms(""2018-07-16 23:00:00""),"
"0","           y     = 2, "
"0","           label = ""bull 3"", "
"0","           size = 8/2.845276, angle = 90, hjust = -0.4, vjust = -0.5) +"
"0","  annotate(geom = ""rect"", "
"0","           xmin = ymd_hms(""2018-11-08 00:00:00""),"
"0","           xmax = ymd_hms(""2019-01-07 23:00:00""), "
"0","           ymin = 2, ymax = 83,"
"0","           fill = ""grey60"", colour = NA, alpha = 0.2) +"
"0","  geom_segment(aes(x    = ymd_hms(""2019-01-07 23:00:00""), "
"0","                   xend = ymd_hms(""2019-01-07 23:00:00""), "
"0","                   y = 2, yend = 83),"
"0","               linetype = ""dashed"", linewidth = 0.4) +"
"0","  annotate(geom  = ""text"","
"0","           x     = ymd_hms(""2019-01-07 23:00:00""),"
"0","           y     = 2, "
"0","           label = ""bull 3"", "
"0","           size = 8/2.845276, angle = 90, hjust = -0.4, vjust = -0.5) +"
"0","  # add the THI data"
"0","  geom_line(aes(x = time, y = thi.mad),"
"0","            linewidth = 0.2, col = ""firebrick"") +"
"0","  # add THI = 72 horizontal line"
"0","  geom_hline(yintercept = 72, linetype = ""solid"", linewidth = 0.4, col = ""black"") +"
"0","  # define axes"
"0","  scale_x_datetime(limits        = ymd_hms(c(""2018-04-01 00:00:00"", ""2019-03-28 00:00:00"")),"
"0","               date_breaks       = ""1 month"", "
"0","               date_minor_breaks = ""1 week"","
"0","               date_labels       = ""%b"","
"0","               expand            = c(0.01, 0.01)) +"
"0","  scale_y_continuous(limits = c(0, 85), "
"0","                     breaks = seq(0,85,10),"
"0","                     expand = c(0.02,0.02)) +"
"0","  # labs"
"0","  labs(x = ""\n2018/2019"","
"0","       y = ""Temperature Humidity Index, THI\n"") +"
"0","  # theme"
"0","  my_theme +"
"0","  theme(axis.text.x = element_text(hjust = -0.3))"
